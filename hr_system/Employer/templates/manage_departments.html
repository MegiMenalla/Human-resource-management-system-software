{% extends 'main.html' %}
{% load static %}
{% block content %}
<h4 class="pl-5 pt-5 mt-5 pb-3 bg-warning">Manage departments:</h4>
<div class="row pl-5 ml-5" style="position: absolute;top: 150px;left: 500px;">
    <form id="forma">
        <div class="form-group">
            <label for="name">Department Name</label>
            <input type="text" class="form-control" id="depname" placeholder="Department name">
        </div>
        <div class="form-group">
            <label for="Parent_department">Under the supervision of:</label>
            <select class="form-control form-control-sm">
                <option>Small select</option>
                <option>Small select</option>
                <option>Small select</option>
            </select>
        </div>


        <button type="submit" class="btn btn-success mt-5">Create new</button>
        <button type="submit" class="btn btn-secondary mt-5">Edit</button>
        <button type="submit" class="btn btn-danger mt-5">Delete</button>
    </form>
</div>
<script>
function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
const csrftoken = getCookie('csrftoken');
console.log('csrftoken');


    var form = document.getElementById('forma')
    form.addEventListener('submit', function(e){
        e.preventDefault()
        console.log('token')
        console.log(csrftoken);
        var url = 'http://127.0.0.1:8000/api/departments/'
        department_name = document.getElementById('depname').value
        fetch(url,{
            method : 'POST',
            headers:{
                'Content-type':'application/json',
                'X-CSFRToken':csrftoken,
            },
            body: JSON.stringify({'department_name': department_name})
        }).then(function(response){
            console.log('inside')
        })
    })

</script>

{% endblock %}